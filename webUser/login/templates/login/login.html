{% extends "app/base.html" %}
{% load static %}

{% block login-content %}
<section class="auth-section">
    <div class="container">
        <div class="auth-container">
            <div class="auth-image">
                <img src="{% static "img/5765700.jpg" %}" alt="Đăng nhập">
            </div>
            <div class="auth-form">
                <h2>Đăng Nhập</h2>
                <p class="auth-description">Đăng nhập để quản lý thông tin đỗ xe của bạn</p>
                
                <form id="loginForm" method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="email">Email</label>
                        <div class="input-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="email" name="email" placeholder="Nhập email của bạn" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Mật Khẩu</label>
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" name="password" placeholder="Nhập mật khẩu của bạn" required>
                            <i class="fas fa-eye toggle-password"></i>
                        </div>
                    </div>
                    
                    <div class="form-options">
                        <div class="remember-me">
                            <input type="checkbox" id="rememberMe">
                            <label for="rememberMe">Ghi nhớ đăng nhập</label>
                        </div>
                        <a href="#" class="forgot-password">Quên mật khẩu?</a>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-large">Đăng Nhập</button>
                </form>
                
                {% comment %} <div class="social-login">
                    <p>Hoặc đăng nhập với</p>
                    <div class="social-buttons">
                        <button class="btn btn-social btn-google">
                            <i class="fab fa-google"></i> Google
                        </button>
                        <button class="btn btn-social btn-facebook">
                            <i class="fab fa-facebook-f"></i> Facebook
                        </button>
                    </div>
                </div> {% endcomment %}
                
                <div class="auth-redirect">
                    <p>Chưa có tài khoản? <a href="{% url "register" %}">Đăng ký ngay</a></p>
                </div>
            </div>
        </div>
    </div>
</section>


<script>
    document.getElementById('loginForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Ngăn chặn form gửi đi mặc định

        const formData = new FormData(this);

        fetch("", {
            method: 'POST',
            headers: {
                'X-CSRFToken': csrftoken,
            },
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                Swal.fire({
                    icon: 'success',
                    title: data.message,
                    timer: 3000,
                    showConfirmButton: false
                }).then(() => {
                    window.location.href = '/'; // Chuyển hướng sau khi đăng nhập thành công
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: data.message,
                    timer: 3000,
                    showConfirmButton: false
                });
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    });
</script>

{% endblock login-content %}